<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>Outlook ì¼€ì´ìŠ¤ íƒ€ì„ë¼ì¸ ë¶„ì„ê¸° (Pre-decode Base64)</title>

  <style>
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:#f3f4f6;
      color:#111;
    }
    header{
      position:sticky;top:0;z-index:10;
      background:linear-gradient(90deg,#1e40af,#0f766e);
      color:#fff;padding:12px 20px;
      display:flex;justify-content:space-between;align-items:center;gap:12px;
      box-shadow:0 2px 6px rgba(0,0,0,.2);
    }
    .title{font-size:18px;font-weight:600}
    .file-box{
      display:flex;align-items:center;gap:8px;
      background:rgba(255,255,255,.2);padding:6px 12px;
      border-radius:999px;font-size:12px
    }
    #dropZone{
      border:2px dashed #9ca3af;background:#fff;padding:30px;
      border-radius:12px;text-align:center;font-size:13px;color:#6b7280;margin-bottom:12px
    }
    #dropZone.dragover{border-color:#2563eb;background:#eff6ff;color:#1d4ed8}
  </style>
</head>
<body>

<header>
  <div>
    <div class="title">Outlook ì¼€ì´ìŠ¤ íƒ€ì„ë¼ì¸ ë¶„ì„ê¸°</div>
  </div>
  <div class="file-box">
    <span>ğŸ“ EML íŒŒì¼ ì„ íƒ</span>
    <input id="fileInput" type="file" multiple accept=".eml" />
  </div>
</header>

<main>
  <section>
    <div id="dropZone">
      ì´ê³³ì— <b>.eml</b> íŒŒì¼ì„ ë“œë˜ê·¸í•´ì„œ ë†“ìœ¼ì„¸ìš”
    </div>
  </section>
  <section>
    <div id="fileStatus" style="font-size:14px;color:#374151;margin-top:10px;"></div>
  </section>
</main>

<script type="module">
  async function handleFiles(files) {
    if (!files.length) return;

    let remain = files.length;

    for (const file of files) {
      const name = file.name;
      const ext = name.split(".").pop().toLowerCase();

      if (ext !== "eml") {
        alert(name + " : ì´ ë²„ì „ì€ .emlë§Œ ì§€ì›í•©ë‹ˆë‹¤.");
        remain--;
        continue;
      }

      const reader = new FileReader();
      reader.onload = (ev) => {
        try {
          let raw = ev.target.result;
          document.getElementById("fileStatus").textContent = `${name} íŒŒì¼ì´ ì„±ê³µì ìœ¼ë¡œ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.`;
        } catch (e) {
          console.error("EML íŒŒì‹± ì‹¤íŒ¨:", name, e);
          document.getElementById("fileStatus").textContent = `íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ${name}`;
        } finally {
          remain--;
          if (remain === 0) {
            document.getElementById("fileStatus").textContent += ` ì´ ${files.length}ê°œì˜ íŒŒì¼ ì²˜ë¦¬ ì™„ë£Œ.`;
          }
        }
      };
      reader.readAsText(file, "utf-8");
    }
  }

  const fileInput = document.getElementById("fileInput");
  const dropZone = document.getElementById("dropZone");
  const fileStatus = document.getElementById("fileStatus");

  fileInput.onchange = (e) => handleFiles([...e.target.files]);

  window.ondragover = (e) => { e.preventDefault(); dropZone.classList.add("dragover"); };
  window.ondragleave = () => dropZone.classList.remove("dragover");
  window.ondrop = (e) => {
    e.preventDefault(); dropZone.classList.remove("dragover");
    handleFiles([...e.dataTransfer.files]);
  };
</script>

</body>
</html>
